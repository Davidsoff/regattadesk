---
###############################################################################
#                           Authelia Configuration                            #
###############################################################################

# Theme can be light, dark, grey or auto.
theme: light

# The default redirection URL
default_redirection_url: http://localhost

# Server Configuration
server:
  host: 0.0.0.0
  port: 9091
  path: ""
  read_buffer_size: 4096
  write_buffer_size: 4096
  enable_pprof: false
  enable_expvars: false
  disable_healthcheck: false

# Log Configuration
log:
  level: info
  format: text

# TOTP Configuration
totp:
  issuer: regattadesk.com
  period: 30
  skew: 1

# Authentication Backend Configuration
authentication_backend:
  # Disable file-based authentication
  file:
    path: ""
    password:
      algorithm: argon2id
      iterations: 1
      salt_length: 16
      parallelism: 8
      memory: 64

# Access Control Configuration
access_control:
  default_policy: deny
  rules:
    # Public API endpoints (no authentication)
    - domain: "*.localhost"
      policy: bypass
      resources:
        - "^/api/v1/public/.*$"
        - "^/api/health$"
        - "^/q/health.*$"
    
    # Staff API endpoints (require authentication)
    - domain: "*.localhost"
      policy: two_factor
      resources:
        - "^/api/v1/staff/.*$"

# Session Configuration
session:
  name: authelia_session
  domain: localhost
  same_site: lax
  expiration: 1h
  inactivity: 5m
  remember_me_duration: 1M

# Regulation Configuration (brute-force protection)
regulation:
  max_retries: 5
  find_time: 2m
  ban_time: 5m

# Storage Configuration (PostgreSQL, DB-only mode - no Redis)
storage:
  encryption_key: ${AUTHELIA_STORAGE_ENCRYPTION_KEY}
  postgres:
    host: ${AUTHELIA_STORAGE_POSTGRES_HOST}
    port: ${AUTHELIA_STORAGE_POSTGRES_PORT}
    database: ${AUTHELIA_STORAGE_POSTGRES_DATABASE}
    username: ${AUTHELIA_STORAGE_POSTGRES_USERNAME}
    password: ${AUTHELIA_STORAGE_POSTGRES_PASSWORD}
    timeout: 5s

# Notifier Configuration (file-based for development)
notifier:
  disable_startup_check: false
  filesystem:
    filename: /config/notification.txt
